<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø±Ø­Ù„Ø© Ø§Ù„Ù…ÙˆÙ„ÙˆØ¯</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #f5f7fb; padding: 20px; }
        .card { max-width: 600px; margin: auto; background: #fff; padding: 25px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        h1 { color: #008069; font-size: 22px; margin-top: 0; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø®Ø·ÙˆØ§Øª */
        .step { position: relative; padding-right: 30px; margin-bottom: 20px; }
        .step::before { 
            content: ''; position: absolute; right: 0; top: 5px; 
            width: 12px; height: 12px; background: #008069; border-radius: 50%; 
        }
        .step::after {
            content: ''; position: absolute; right: 5px; top: 20px;
            width: 2px; height: 100%; background: #eee;
        }
        .step:last-child::after { display: none; }
        .step-title { font-weight: bold; font-size: 16px; }
        .step-desc { font-size: 13px; color: #666; margin-top: 5px; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø¨ÙˆÙƒØ³Ø§Øª */
        .box { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 15px; margin-top: 20px; }
        .btn-action { 
            width: 100%; background: #008069; color: white; border: none; 
            padding: 12px; border-radius: 8px; font-family: inherit; font-weight: bold; 
            cursor: pointer; margin-top: 10px;
        }
        .vaccine-item {
            display: flex; justify-content: space-between; padding: 10px; 
            border-bottom: 1px solid #eee; font-size: 14px;
        }
    </style>
</head>
<body>

<div class="card">
    <a href="journeys.html" style="text-decoration:none; color:#999; float:left">Ø±Ø¬ÙˆØ¹</a>
    <h1>Ø±Ø­Ù„Ø© Ù‚Ø¯ÙˆÙ… Ù…ÙˆÙ„ÙˆØ¯ ğŸ¼</h1>
    
    <div id="steps-container" style="margin-top:20px;">
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¨Ù„ÙŠØº...</p>
    </div>

    <div class="box">
        <h3 style="margin:0 0 10px 0;">ğŸ“… Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ·Ø¹ÙŠÙ…Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</h3>
        <p style="font-size:13px; color:#666">Ø§Ø¶ØºØ· Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (01-09-2025)</p>
        <button class="btn-action" onclick="showVaccines()">Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙˆÙ…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</button>
        
        <div id="vaccine-list" style="margin-top:15px; display:none; background:white; border-radius:8px; border:1px solid #eee;"></div>
    </div>

    <div class="box" style="background:#fff7ed; border-color:#fed7aa">
        <h3 style="margin:0 0 10px 0; color:#c2410c">ğŸ“ Ø£Ù‚Ø±Ø¨ Ù…Ø±ÙƒØ² ØµØ­ÙŠ</h3>
        <button class="btn-action" style="background:#ea580c" onclick="showCenter()">Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø­ÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
        <div id="center-info" style="margin-top:10px; font-weight:bold; color:#c2410c"></div>
    </div>
</div>

<script>
    // 1. Ø£ÙˆÙ„ Ù…Ø§ ØªÙØªØ­ Ø§Ù„ØµÙØ­Ø©: Ø¬ÙŠØ¨ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø±Ø­Ù„Ø©
    window.onload = async function() {
        try {
            const res = await fetch("http://127.0.0.1:5000/api/baby_journey");
            const data = await res.json();
            
            const html = data.steps.map(s => `
                <div class="step">
                    <div class="step-title">${s.title}</div>
                    <div class="step-desc">${s.desc}</div>
                </div>
            `).join('');
            document.getElementById("steps-container").innerHTML = html;
        } catch(e) {
            alert("ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ app.py");
        }
    }

    // 2. Ø²Ø± Ø§Ù„ØªØ·Ø¹ÙŠÙ…Ø§Øª
    async function showVaccines() {
        const listDiv = document.getElementById("vaccine-list");
        listDiv.style.display = "block";
        listDiv.innerHTML = "<p style='padding:10px'>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</p>";

        const res = await fetch("http://127.0.0.1:5000/api/baby_vaccines");
        const data = await res.json();

        const html = data.vaccines.map(v => `
            <div class="vaccine-item">
                <span>ğŸ’‰ ${v.name}</span>
                <span style="color:#008069; font-weight:bold">${v.due_date}</span>
            </div>
        `).join('');
        listDiv.innerHTML = html;
    }

    // 3. Ø²Ø± Ø§Ù„Ù…Ø±ÙƒØ²
    async function showCenter() {
        const res = await fetch("http://127.0.0.1:5000/api/nearest_center");
        const data = await res.json();
        document.getElementById("center-info").innerText = `âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯:$ `;{data.center.name}
    }
</script>

</body>
</html>